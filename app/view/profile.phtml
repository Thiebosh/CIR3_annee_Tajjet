<?php ob_start(); ?>
        <div class="infos d-flex justify-content-center">

            <div class="col-md-6 infos_compte">
                <h1>Informations de compte</h1>
                <hr>
                <form method="post" action="index.php?user=profile">
                    <p>
                        <label for="username">Nom d'utilisateur</label><br>
                        <input type="text" class="form-control" name="username" placeholder="<?= htmlspecialchars($_SESSION['user']->getName()) ?>" value="<?= isset($trustedPost['name']) ? htmlspecialchars($trustedPost['name']) : '' ?>">
                        <br>
                        <label for="password">Mot de passe</label><br>
                        <input type="password" class="form-control" name="password" placeholder="Nouveau mot de passe">
                        <br>
                        <label for="passwordConf">Confirmer le mot de passe</label><br>
                        <input type="password" class="form-control" name="passwordConf" placeholder="Confirmer le nouveau mot de passe">
                    </p>
                    
                    <p class="d-flex justify-content-center">
                        <input type="submit" class="btn btn-outline-success" value="Modifier mes identifiants"/>
                    </p>
                </form>
            </div>
            
            <div class="col-md-6 infos_perso">
                <h1>Informations personnelles</h1>
                <hr>
                
                <div>
                    <label for="avatar">Avatar</label>
                    
                    <form method="post" action="index.php?user=profile" enctype="multipart/form-data">
                        <input type="file" name="avatar" accept=".png">
                        <input type="submit" name="import">
                    </form>
                </div>
                <form method="post" action="index.php?user=profile">
                
                    <?php
                    $dir="resource/image/avatars";
                    $taille_maxi=100000;
                    $extensions = array('.png', '.gif', '.jpg', '.jpeg',".JPG");
                    if (!isset($_FILES['avatar']['tmp_name'])) {
                        if(file_exists($dir)){//On regarde si l'avatar a déjà été importé
                            
                            if(sizeof(scandir($dir))>2){
                                $name=scandir($dir)[2];
                                if(file_exists($dir."/".$name)){ 
                                    echo '<img src="'.$dir.'/'.$name.'">';
                                    
                                }
                            }
                        }
                    }
                    else { //Si l'utilisateur a importé un fichier
                        
                        $taille = filesize($_FILES['avatar']['tmp_name']); //On récupère la taille et l'extension du fichier
                        $extension = strrchr($_FILES['avatar']['name'], '.'); 
                        
                        if($taille>$taille_maxi)
                        {
                            $erreur = 'Votre fichier dépasse la taille maximale';
                        }
                        if(!in_array($extension, $extensions)) //Si l'extension n'est pas dans le tableau
                        {
                            $erreur = 'Votre fichier doit être de type png, gif, jpg ou jpeg';
                        }

                        if(!isset($erreur)){ //On regarde s'il y a une erreur
                            if(file_exists($dir)){ //On regarde si le dossier avatars existe
                                
                                if(!file_exists($dir.$_FILES['avatar']['name'])){ //Si l'avatar n'a pas déjà été importé, alors on l'importe et l'affiche
                                    if(sizeof(scandir($dir))>2){ //Il y a déjà un fichier dans le dossier : on le supprime
                                        $name=scandir($dir)[2];
                                        unlink($dir.'/'.$name);
                                    }
                                    $retour = copy($_FILES['avatar']['tmp_name'], $dir.'/'.$_FILES['avatar']['name']);
                                    if($retour) {
                                    echo '<img src="'.$dir.'/' . $_FILES['avatar']['name'] . '">';
                                    } 
                                }
                            }
                            else{ //S'il n'existe pas, on le crée, on importe l'image et on l'affiche
                                if(mkdir("$dir",0777,true)){
                                    $retour = copy($_FILES['avatar']['tmp_name'], $dir.'/'.$_FILES['avatar']['name']);
                                    if($retour) {
                                    echo '<img src="'.$dir.'/' . $_FILES['avatar']['name'] . '">';
                                    }
                                }
                            }
                        }
                        else{
                            echo($erreur);
                        }
                    }
                    
                    ?>
                    <p>
                        <br>
                        <label for="birthDate">Votre date de naissance</label><br>
                        <input type="date" class="form-control" name="birthDate" value="<?= htmlspecialchars(isset($trustedPost['birthDate']) ? $trustedPost['birthDate'] : $_SESSION['user']->getBirthDate() != null ? $_SESSION['user']->getBirthDate() : '') ?>">
                        <br>
                        <label for="height">Votre taille</label><br>
                        <input type="text" class="form-control" name="height" id="height" placeholder="<?= htmlspecialchars($_SESSION['user']->getHeight())?>" value="<?= isset($trustedPost['height']) ? htmlspecialchars($trustedPost['height']) : '' ?>">
                        <br>
                        <label for="town">Votre ville</label><br>
                        <input type="text" class="form-control" name="town" id="town" placeholder="<?= htmlspecialchars($_SESSION['user']->getTown()->getLabel()) ?>" value="<?= isset($trustedPost['town']) ? htmlspecialchars($trustedPost['town']) : '' ?>">
                    </p>
                    
                    <p class="d-flex justify-content-center">
                        <input type="submit" class="btn btn-outline-success" value="Modifier mes informations personnelles"/>
                    </p>
                </form>  
            </div>
<?php $sectionContent=ob_get_clean();

//ajouter script js pour afficher formulaire (ou champs et bouton de validation) avec un clic bouton "modifier mes données" ?